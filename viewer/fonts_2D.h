/*
 * fonts_2d.h
 *
 *  Copyright (C) 2015 Diamond Light Source
 *
 *  Author: Luis Fuentes-Montero (Luiso)
 *
 *  This code is distributed under the BSD license, a copy of which is
 *  included in the root directory of this package.
 */

#ifndef DIALS_FONTS_LOW_LEVEL_H
#define DIALS_FONTS_LOW_LEVEL_H
#include <iostream>
#include <string>
#include <cmath>
#include <scitbx/array_family/flex_types.h>

using scitbx::af::flex_double;
using scitbx::af::flex_int;
using scitbx::af::flex_grid;

int get_font_img_array( int (&font_bw_img)[14][7][16]){

  int err_cod = 0;

  int arr_2d_0[14][7] = {{0,0,0,0,0,0,0},
                         {0,0,0,0,0,0,0},
                         {0,0,1,1,1,1,0},
                         {0,0,1,1,1,1,0},
                         {0,1,1,0,0,1,1},
                         {0,1,1,0,0,1,1},
                         {0,1,0,0,1,0,1},
                         {0,1,0,0,1,0,1},
                         {0,1,0,1,0,0,1},
                         {0,1,0,1,0,0,1},
                         {0,0,1,1,1,1,0},
                         {0,0,1,1,1,1,0},
                         {0,0,0,0,0,0,0},
                         {0,0,0,0,0,0,0}};
  for (int row = 0; row < 7 ; row++) {
    for (int col = 0; col < 14; col++) {
      font_bw_img[col][row][0] = arr_2d_0[col][row];
    }
  }

  int arr_2d_1[14][7] =  {{0,0,0,0,0,0,0},
                          {0,0,0,0,0,0,0},
                          {0,1,1,1,0,0,0},
                          {0,1,1,1,0,0,0},
                          {0,0,0,1,0,0,0},
                          {0,0,0,1,0,0,0},
                          {0,0,0,1,0,0,0},
                          {0,0,0,1,0,0,0},
                          {0,0,0,1,0,0,0},
                          {0,0,0,1,0,0,0},
                          {0,1,1,1,1,1,0},
                          {0,1,1,1,1,1,0},
                          {0,0,0,0,0,0,0},
                          {0,0,0,0,0,0,0}};
  for (int row = 0; row < 7 ; row++) {
    for (int col = 0; col < 14; col++) {
      font_bw_img[col][row][1] = arr_2d_1[col][row];
    }
  }

  int arr_2d_2[14][7] =  {{0,0,0,0,0,0,0},
                          {0,0,0,0,0,0,0},
                          {0,0,1,1,1,1,0},
                          {0,0,1,1,1,1,0},
                          {0,1,0,0,0,1,1},
                          {0,1,0,0,0,1,1},
                          {0,0,0,0,1,1,0},
                          {0,0,0,0,1,1,0},
                          {0,0,0,1,1,0,0},
                          {0,0,0,1,1,0,0},
                          {0,1,1,1,1,1,1},
                          {0,1,1,1,1,1,1},
                          {0,0,0,0,0,0,0},
                          {0,0,0,0,0,0,0}};
  for (int row = 0; row < 7 ; row++) {
    for (int col = 0; col < 14; col++) {
      font_bw_img[col][row][2] = arr_2d_2[col][row];
    }
  }

  int arr_2d_3[14][7] =  {{0,0,0,0,0,0,0},
                          {0,0,0,0,0,0,0},
                          {0,0,1,1,1,1,0},
                          {0,0,1,1,1,1,0},
                          {0,1,0,0,0,1,1},
                          {0,1,0,0,0,1,1},
                          {0,0,0,1,1,1,0},
                          {0,0,0,1,1,1,0},
                          {0,0,0,0,0,1,1},
                          {0,0,0,0,0,1,1},
                          {0,1,1,1,1,1,0},
                          {0,1,1,1,1,1,0},
                          {0,0,0,0,0,0,0},
                          {0,0,0,0,0,0,0}};
  for (int row = 0; row < 7 ; row++) {
    for (int col = 0; col < 14; col++) {
      font_bw_img[col][row][3] = arr_2d_3[col][row];
    }
  }

  int arr_2d_4[14][7] =  {{0,0,0,0,0,0,0},
                          {0,0,0,0,0,0,0},
                          {0,0,0,0,1,1,0},
                          {0,0,0,0,1,1,0},
                          {0,0,0,1,1,1,0},
                          {0,0,0,1,1,1,0},
                          {0,0,1,1,0,1,0},
                          {0,0,1,1,0,1,0},
                          {0,1,1,1,1,1,1},
                          {0,1,1,1,1,1,1},
                          {0,0,0,0,0,1,0},
                          {0,0,0,0,0,1,0},
                          {0,0,0,0,0,0,0},
                          {0,0,0,0,0,0,0}};
  for (int row = 0; row < 7 ; row++) {
    for (int col = 0; col < 14; col++) {
      font_bw_img[col][row][4] = arr_2d_4[col][row];
    }
  }

  int arr_2d_5[14][7] =  {{0,0,0,0,0,0,0},
                          {0,0,0,0,0,0,0},
                          {0,1,1,1,1,1,0},
                          {0,1,1,1,1,1,0},
                          {0,1,0,0,0,0,0},
                          {0,1,0,0,0,0,0},
                          {0,1,1,1,1,1,1},
                          {0,1,1,1,1,1,1},
                          {0,0,0,0,0,0,1},
                          {0,0,0,0,0,0,1},
                          {0,1,1,1,1,1,1},
                          {0,1,1,1,1,1,1},
                          {0,0,0,0,0,0,0},
                          {0,0,0,0,0,0,0}};
  for (int row = 0; row < 7 ; row++) {
    for (int col = 0; col < 14; col++) {
      font_bw_img[col][row][5] = arr_2d_5[col][row];
    }
  }

  int arr_2d_6[14][7] =  {{0,0,0,0,0,0,0},
                          {0,0,0,0,0,0,0},
                          {0,0,1,1,1,1,0},
                          {0,0,1,1,1,1,0},
                          {0,1,1,0,0,0,0},
                          {0,1,1,0,0,0,0},
                          {0,1,1,1,1,1,1},
                          {0,1,1,1,1,1,1},
                          {0,1,1,0,0,0,1},
                          {0,1,1,0,0,0,1},
                          {0,0,1,1,1,1,1},
                          {0,0,1,1,1,1,1},
                          {0,0,0,0,0,0,0},
                          {0,0,0,0,0,0,0}};
  for (int row = 0; row < 7 ; row++) {
    for (int col = 0; col < 14; col++) {
      font_bw_img[col][row][6] = arr_2d_6[col][row];
    }
  }

  int arr_2d_7[14][7] =  {{0,0,0,0,0,0,0},
                          {0,0,0,0,0,0,0},
                          {0,1,1,1,1,1,1},
                          {0,1,1,1,1,1,1},
                          {0,0,0,0,0,1,1},
                          {0,0,0,0,0,1,1},
                          {0,0,0,0,1,1,0},
                          {0,0,0,0,1,1,0},
                          {0,0,0,1,1,0,0},
                          {0,0,0,1,1,0,0},
                          {0,0,1,1,0,0,0},
                          {0,0,1,1,0,0,0},
                          {0,0,0,0,0,0,0},
                          {0,0,0,0,0,0,0}};
  for (int row = 0; row < 7 ; row++) {
    for (int col = 0; col < 14; col++) {
      font_bw_img[col][row][7] = arr_2d_7[col][row];
    }
  }

  int arr_2d_8[14][7] =  {{0,0,0,0,0,0,0},
                          {0,0,0,0,0,0,0},
                          {0,0,1,1,1,1,0},
                          {0,0,1,1,1,1,0},
                          {0,1,1,0,0,1,1},
                          {0,1,1,0,0,1,1},
                          {0,0,1,1,1,1,0},
                          {0,0,1,1,1,1,0},
                          {0,1,1,0,0,1,1},
                          {0,1,1,0,0,1,1},
                          {0,0,1,1,1,1,0},
                          {0,0,1,1,1,1,0},
                          {0,0,0,0,0,0,0},
                          {0,0,0,0,0,0,0}};
  for (int row = 0; row < 7 ; row++) {
    for (int col = 0; col < 14; col++) {
      font_bw_img[col][row][8] = arr_2d_8[col][row];
    }
  }

  int arr_2d_9[14][7] =  {{0,0,0,0,0,0,0},
                          {0,0,0,0,0,0,0},
                          {0,0,1,1,1,1,0},
                          {0,0,1,1,1,1,0},
                          {0,1,1,0,0,1,1},
                          {0,1,1,0,0,1,1},
                          {0,1,1,1,1,1,1},
                          {0,1,1,1,1,1,1},
                          {0,0,0,0,0,1,1},
                          {0,0,0,0,0,1,1},
                          {0,1,1,1,1,1,0},
                          {0,1,1,1,1,1,0},
                          {0,0,0,0,0,0,0},
                          {0,0,0,0,0,0,0}};
  for (int row = 0; row < 7 ; row++) {
    for (int col = 0; col < 14; col++) {
      font_bw_img[col][row][9] = arr_2d_9[col][row];
    }
  }

  int arr_2d_point[14][7] =  {{0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,1,1,0,0},
                              {0,0,0,1,1,0,0},
                              {0,0,0,1,1,0,0},
                              {0,0,0,1,1,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0}};
  for (int row = 0; row < 7 ; row++) {
    for (int col = 0; col < 14; col++) {
      font_bw_img[col][row][10] = arr_2d_point[col][row];
    }
  }

  int arr_2d_e[14][7] =  {{0,0,0,0,0,0,0},
                          {0,0,0,0,0,0,0},
                          {0,0,1,1,1,1,0},
                          {0,0,1,1,1,1,0},
                          {0,1,1,0,0,1,0},
                          {0,1,1,0,0,1,0},
                          {0,1,1,1,1,1,0},
                          {0,1,1,1,1,1,0},
                          {0,1,1,0,0,0,0},
                          {0,1,1,0,0,0,0},
                          {0,0,1,1,1,1,0},
                          {0,0,1,1,1,1,0},
                          {0,0,0,0,0,0,0},
                          {0,0,0,0,0,0,0}};
  for (int row = 0; row < 7 ; row++) {
    for (int col = 0; col < 14; col++) {
      font_bw_img[col][row][11] = arr_2d_e[col][row];
    }
  }

  int arr_2d_plus[14][7] = {{0,0,0,0,0,0,0},
                            {0,0,0,0,0,0,0},
                            {0,0,0,1,0,0,0},
                            {0,0,0,1,0,0,0},
                            {0,0,0,1,0,0,0},
                            {0,0,0,1,0,0,0},
                            {0,1,1,1,1,1,0},
                            {0,1,1,1,1,1,0},
                            {0,0,0,1,0,0,0},
                            {0,0,0,1,0,0,0},
                            {0,0,0,1,0,0,0},
                            {0,0,0,1,0,0,0},
                            {0,0,0,0,0,0,0},
                            {0,0,0,0,0,0,0}};
  for (int row = 0; row < 7 ; row++) {
    for (int col = 0; col < 14; col++) {
      font_bw_img[col][row][12] = arr_2d_plus[col][row];
    }
  }

  int arr_2d_minus[14][7] =  {{0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,1,1,1,1,1,0},
                              {0,1,1,1,1,1,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0}};
  for (int row = 0; row < 7 ; row++) {
    for (int col = 0; col < 14; col++) {
      font_bw_img[col][row][13] = arr_2d_minus[col][row];
    }
  }

  int arr_2d_space[14][7] =  {{0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0},
                              {0,0,0,0,0,0,0}};
  for (int row = 0; row < 7 ; row++) {
    for (int col = 0; col < 14; col++) {
      font_bw_img[col][row][14] = arr_2d_space[col][row];
    }
  }

  int arr_2d_null[14][7] = {{0,0,0,0,0,0,0},
                            {0,0,0,0,0,0,0},
                            {0,0,0,0,0,0,0},
                            {0,0,0,0,0,0,0},
                            {0,0,0,0,0,0,0},
                            {0,0,0,0,0,0,0},
                            {0,0,0,0,0,0,0},
                            {0,0,0,0,0,0,0},
                            {0,0,0,0,0,0,0},
                            {0,0,0,0,0,0,0},
                            {0,0,0,0,0,0,0},
                            {0,0,0,0,0,0,0},
                            {0,0,0,0,0,0,0},
                            {0,0,0,0,0,0,0}};
  for (int row = 0; row < 7 ; row++) {
    for (int col = 0; col < 14; col++) {
      font_bw_img[col][row][15] = arr_2d_null[col][row];
    }
  }

  return err_cod;
}

int get_digits( double nm, int (&dgt_num)[15]){

  int err_cod = 0;
  bool end_reached;

  char asc_str[15];

  std::string str;
  //std::cout << "nm =" << nm << "\n";
  snprintf (asc_str, 15, "               ");
  //snprintf ( char * s, size_t n, const char * format, ... );
  snprintf (asc_str, 15, "%g", nm);

  /*
    * cx = snprintf ( buffer, 100, "The half of %d is %d", 60, 60/2 );
    */

  //std::cout << "asc_str = <<" << asc_str << ">>\n\n";
  str = asc_str;
  end_reached = false;
  for (int i = 0; i < 13; i++){
    str = asc_str[i];
    dgt_num[i] = asc_str[i] - 48;

    if( dgt_num[i] < 0 or dgt_num[i] > 9 ){
      if( str == "." ){
        dgt_num[i] = 10;
      }else if( str == "e" ){
        dgt_num[i] = 11;
      }else if( str == "+" ){
        dgt_num[i] = 12;
      }else if( str == "-" ){
        dgt_num[i] = 13;
      }else if( str == " " ){
        dgt_num[i] = 14;
      }else if( asc_str[i] == 0 ){
        dgt_num[i] = 15;
        end_reached = true;
      }else{
        if( end_reached == false ){
          //std::cout << "\nfound \'" << str << "\' and not converted";
          err_cod = asc_str[i];
          //std::cout << "\n char(" << err_cod << ") found\n";
          err_cod = 1;
        }

      }
    }
    //std::cout << " {" << asc_str[i] << "} " << "["<< dgt_num[i] <<"],";
  }

  if(end_reached == false){
    //std::cout << "\n to long number, err 2 \n";
    err_cod = 2;
  }
  //std::cout << "\nerr_cod =" << err_cod << "\n";

  return err_cod;
}


#endif
